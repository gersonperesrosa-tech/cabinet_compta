{% extends "base.html" %}

{% block content %}

<section class="section">


<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Modules TVA – {{ annee.annee }}</h1>

    <a href="{% url 'tva_annees' %}" class="btn btn-outline-secondary">
        Retour aux années
    </a>
</div>

<table class="table table-hover align-middle">
    <thead>
        <tr>
            <th>Module</th>
            <th>Type</th>
            <th>Clients</th>
            <th>Actions</th>
        </tr>
    </thead>

    <tbody>
        {% for m in modules %}
        <tr>
            <td><strong>{{ m.get_type_display }}</strong></td>

            <td>
                <span class="badge bg-primary">{{ m.type }}</span>
            </td>

            <td>
                {{ m.clients.count }} client{{ m.clients.count|pluralize }}
            </td>

            <td>

                <!-- Bouton Gérer les clients -->
                <a href="{% url 'tva_clients_module' m.id %}"
                   class="btn btn-sm btn-outline-primary">
                    Gérer les clients
                </a>

                <!-- Bouton Saisir TVA (redirige vers la gestion des clients pour choisir le client) -->
                {% if m.type == "CA3M" %}
                    <a href="{% url 'tva_clients_module' m.id %}"
                       class="btn btn-sm btn-outline-success">
                        Saisir TVA mensuelle
                    </a>
                {% elif m.type == "CA3T" %}
                    <a href="{% url 'tva_clients_module' m.id %}"
                       class="btn btn-sm btn-outline-success">
                        Saisir TVA trimestrielle
                    </a>
                {% elif m.type == "CA12" %}
                    <a href="{% url 'tva_clients_module' m.id %}"
                       class="btn btn-sm btn-outline-success">
                        Saisir TVA annuelle
                    </a>
                {% endif %}

            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}
