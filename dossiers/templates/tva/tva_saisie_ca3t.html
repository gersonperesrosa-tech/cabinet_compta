{% extends "base.html" %}
{% load custom_tags %}

{% block content %}

<section class="section">

<h1>Saisie TVA trimestrielle – {{ tca.client.nom }} ({{ tca.module.annee.annee }})</h1>

<form method="POST">
    {% csrf_token %}

    <table class="table table-bordered align-middle mt-4">
        <thead>
            <tr>
                <th>Trimestre</th>
                <th>Montant TVA</th>
                <th>Statut</th>
            </tr>
        </thead>

        <tbody>

            <!-- T1 -->
            <tr>
                <td><strong>T1</strong> (Janv–Fév–Mars)</td>
                <td>
                    <input type="text" name="ca3t_t1" class="form-control"
                           value="{{ declaration.ca3t_t1 }}">
                </td>
                <td>
                    <select name="statut_t1" class="form-select">
                        {% for code, label in declaration.TVA_STATUTS %}
                            <option value="{{ code }}"
                                {% if declaration.statut_t1 == code %}selected{% endif %}>
                                {{ label }}
                            </option>
                        {% endfor %}
                    </select>
                </td>
            </tr>

            <!-- T2 -->
            <tr>
                <td><strong>T2</strong> (Avr–Mai–Juin)</td>
                <td>
                    <input type="text" name="ca3t_t2" class="form-control"
                           value="{{ declaration.ca3t_t2 }}">
                </td>
                <td>
                    <select name="statut_t2" class="form-select">
                        {% for code, label in declaration.TVA_STATUTS %}
                            <option value="{{ code }}"
                                {% if declaration.statut_t2 == code %}selected{% endif %}>
                                {{ label }}
                            </option>
                        {% endfor %}
                    </select>
                </td>
            </tr>

            <!-- T3 -->
            <tr>
                <td><strong>T3</strong> (Juil–Août–Sept)</td>
                <td>
                    <input type="text" name="ca3t_t3" class="form-control"
                           value="{{ declaration.ca3t_t3 }}">
                </td>
                <td>
                    <select name="statut_t3" class="form-select">
                        {% for code, label in declaration.TVA_STATUTS %}
                            <option value="{{ code }}"
                                {% if declaration.statut_t3 == code %}selected{% endif %}>
                                {{ label }}
                            </option>
                        {% endfor %}
                    </select>
                </td>
            </tr>

            <!-- T4 -->
            <tr>
                <td><strong>T4</strong> (Oct–Nov–Déc)</td>
                <td>
                    <input type="text" name="ca3t_t4" class="form-control"
                           value="{{ declaration.ca3t_t4 }}">
                </td>
                <td>
                    <select name="statut_t4" class="form-select">
                        {% for code, label in declaration.TVA_STATUTS %}
                            <option value="{{ code }}"
                                {% if declaration.statut_t4 == code %}selected{% endif %}>
                                {{ label }}
                            </option>
                        {% endfor %}
                    </select>
                </td>
            </tr>

        </tbody>
    </table>

    <!-- BOUTONS BAS DE PAGE -->
    <div class="d-flex justify-content-between align-items-center mt-4">

        <!-- Bouton gauche : Retour au Module Trimestriel -->
        <a href="{% url 'tva_clients_module' tca.module.id %}"
           class="btn btn-outline-secondary">
            Retour au Module Trimestriel
        </a>

        <div class="d-flex gap-2">

            <!-- Bouton centre : Retour à la gestion CA3T -->
            <a href="{% url 'tva_gestion_ca3t' %}?annee={{ tca.annee.id }}"
               class="btn btn-outline-dark">
                Retour
            </a>

            <!-- Bouton droite : Enregistrer -->
            <button type="submit" class="btn btn-primary">
                Enregistrer
            </button>

        </div>

    </div>

</form>

{% endblock %}
